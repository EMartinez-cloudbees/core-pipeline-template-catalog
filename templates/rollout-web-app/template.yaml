version: 1
type: pipeline-template
name: Rollout App Multibranch Pipeline
templateType: MULTIBRANCH
description: Test, Build and Deploy for Rollout Workshop WebApp using a .rollout-web-app as the marker file. You must add a '.rollout-web-app' file to each branch you want built. 
parameters:
  - name: repoOwner
    type: string
    displayName: Repository Owner
  - name: npmPackages
    type: string
    displayName: Default NPM Packages
    defaultValue: express pug
  - name: githubCredentialId
    displayName: GitHub Credential ID
    type: CREDENTIALS
    defaultValue: github-avsyug
  - name: gcpProject
    type: string
    displayName: GCP Project
    defaultValue: core-workshop
multibranch:
  branchSource:
    github:
      id: Rollout-Workshop-Final
      credentialsId: ${githubCredentialId}
      repoOwner: ${repoOwner}
      repository: 'Rollout-Workshop-Final'
  markerFile: .rollout-web-app
